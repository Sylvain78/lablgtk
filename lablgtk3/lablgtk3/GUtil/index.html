<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>GUtil (lablgtk3.GUtil)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">lablgtk3</a> &#x00BB; GUtil</nav><header class="odoc-preamble"><h1>Module <code><span>GUtil</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#utility-classes-for-programming-with-gtk-objects">Utility classes for programming with GTK objects</a><ul><li><a href="#the-ml-signal-mechanism">The ML signal mechanism</a></li><li><a href="#propagating-state-modifications">Propagating state modifications</a></li></ul></li></ul></nav><div class="odoc-content"><h4 id="utility-classes-for-programming-with-gtk-objects"><a href="#utility-classes-for-programming-with-gtk-objects" class="anchor"></a>Utility classes for programming with GTK objects</h4><div class="odoc-spec"><div class="spec value" id="val-print_widget" class="anchored"><a href="#val-print_widget" class="anchor"></a><code><span><span class="keyword">val</span> print_widget : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">GObj</span>.#widget <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>A nice function to use with <code>#install_printer</code></p></div></div><p>The memo class provides an easy way to remember the real class of a widget. Insert all widgets of class in one single <code>t memo</code>, and you can then recover their original ML object with <code>#find</code>.</p><div class="odoc-spec"><div class="spec class" id="class-memo" class="anchored"><a href="#class-memo" class="anchor"></a><code><span><span class="keyword">class</span> 'a </span><span><a href="class-memo/index.html">memo</a></span><span> : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><h5 id="the-ml-signal-mechanism"><a href="#the-ml-signal-mechanism" class="anchor"></a>The ML signal mechanism</h5><p>It allows one to add GTK-like signals to arbitrary objects.</p><div class="odoc-spec"><div class="spec value" id="val-next_callback_id" class="anchored"><a href="#val-next_callback_id" class="anchor"></a><code><span><span class="keyword">val</span> next_callback_id : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../GtkSignal/index.html#type-id">GtkSignal.id</a></span></code></div></div><div class="odoc-spec"><div class="spec class" id="class-signal" class="anchored"><a href="#class-signal" class="anchor"></a><code><span><span class="keyword">class</span> 'a </span><span><a href="class-signal/index.html">signal</a></span><span> : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><p>As with GTK signals, you can use <code>GtkSignal.stop_emit</code> inside a callback to prevent other callbacks from being called.</p><div class="odoc-spec"><div class="spec class" id="class-ml_signals" class="anchored"><a href="#class-ml_signals" class="anchor"></a><code><span><span class="keyword">class</span> <span class="keyword">virtual</span>  </span><span><a href="class-ml_signals/index.html">ml_signals</a></span><span> : <span><span><span>(<span><a href="../GtkSignal/index.html#type-id">GtkSignal.id</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec class" id="class-add_ml_signals" class="anchored"><a href="#class-add_ml_signals" class="anchor"></a><code><span><span class="keyword">class</span> <span class="keyword">virtual</span>  </span><span><a href="class-add_ml_signals/index.html">add_ml_signals</a></span><span> : <span><span><span class="type-var">'a</span> <a href="../Gtk/index.html#type-obj">Gtk.obj</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><a href="../GtkSignal/index.html#type-id">GtkSignal.id</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><p>To add ML signals to a LablGTK object:</p><pre><code>class mywidget_signals obj ~mysignal1 ~mysignal2 = object
  inherit somewidget_signals obj
  inherit add_ml_signals obj [mysignal1#disconnect; mysignal2#disconnect]
  method mysignal1 = mysignal1#connect ~after
  method mysignal2 = mysignal2#connect ~after
end

class mywidget obj = object (self)
  inherit somewidget obj
  val mysignal1 = new signal obj
  val mysignal2 = new signal obj
  method connect = new mywidget_signals obj ~mysignal1 ~mysignal2
  method call1 = mysignal1#call
  method call2 = mysignal2#call
end</code></pre><p>You can also add ML signals to an arbitrary object; just inherit from <code>ml_signals</code> in place of <code>widget_signals</code>+<code>add_ml_signals</code>.</p><pre><code>class mysignals ~mysignal1 ~mysignal2 = object
   inherit ml_signals [mysignal1#disconnect; mysignal2#disconnect]
   method mysignal1 = mysignal1#connect ~after
   method mysignal2 = mysignal2#connect ~after
 end</code></pre><h5 id="propagating-state-modifications"><a href="#propagating-state-modifications" class="anchor"></a>Propagating state modifications</h5><p>The variable class provides an easy way to propagate state modifications. A new variable is created by <code>new variable init</code>. The <code>#set</code> method just calls the <code>set</code> signal, which by default only calls <code>real_set</code>. <code>real_set</code> sets the variable and calls <code>changed</code> when needed. Deep equality is used to compare values, but check is only done if there are callbacks for <code>changed</code>.</p><div class="odoc-spec"><div class="spec class" id="class-variable_signals" class="anchored"><a href="#class-variable_signals" class="anchor"></a><code><span><span class="keyword">class</span> 'a </span><span><a href="class-variable_signals/index.html">variable_signals</a></span><span> : <span>set:<span><span class="type-var">'a</span> <a href="class-signal/index.html">signal</a></span> <span class="arrow">&#45;&gt;</span></span> <span>changed:<span><span class="type-var">'a</span> <a href="class-signal/index.html">signal</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec class" id="class-variable" class="anchored"><a href="#class-variable" class="anchor"></a><code><span><span class="keyword">class</span> 'a </span><span><a href="class-variable/index.html">variable</a></span><span> : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>